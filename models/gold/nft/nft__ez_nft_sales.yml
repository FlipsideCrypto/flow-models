version: 2

models:
  - name: nft__ez_nft_sales
    description: |-
      This ez_ view is the same data table as the prior `fact_nft_sales` view. NFT market sales on the Flow blockchain. Currently supported in this ez_ view are transactions that interact with the primary NFT Marketplace contract (), the Fabricant NFT Marketplace contract, and NBA TopShot primary market sales. More markets can and will be added.

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - tx_id
            - seller
            - buyer
            - nft_collection
            - nft_id

    columns:
      - name: TX_ID
        description: "{{ doc('tx_id') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - STRING
                - VARCHAR

      - name: BLOCK_HEIGHT
        description: "{{ doc('block_height') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - NUMBER
                - FLOAT

      - name: BLOCK_TIMESTAMP
        description: "{{ doc('block_timestamp') }}"
        tests:
          - not_null
          - dbt_expectations.expect_row_values_to_have_recent_data:
              datepart: day
              interval: 1
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - TIMESTAMP_NTZ

      - name: MARKETPLACE
        description: "{{ doc('marketplace') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - STRING
                - VARCHAR

      - name: NFT_COLLECTION
        description: "{{ doc('nft_collection') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - STRING
                - VARCHAR

      - name: NFT_ID
        description: "{{ doc('nft_id') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - STRING
                - VARCHAR
                - NUMBER

      - name: BUYER
        description: "{{ doc('buyer') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - STRING
                - VARCHAR

      - name: SELLER
        description: "{{ doc('seller') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - STRING
                - VARCHAR

      - name: PRICE
        description: "{{ doc('price') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - NUMBER
                - FLOAT
                - DOUBLE

      - name: CURRENCY
        description: "{{ doc('currency') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - STRING
                - VARCHAR

      - name: TX_SUCCEEDED
        description: "{{ doc('tx_succeeded') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - BOOLEAN

      - name: TOKENFLOW
        description: "{{ doc('tokenflow') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - ARRAY
                - OBJECT
                - VARIANT

      - name: COUNTERPARTIES
        description: "{{ doc('counterparties') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - ARRAY
                - OBJECT
                - VARIANT

      - name: NFT_SALES_ID
        description: "{{ doc('pk_id') }}"

      - name: INSERTED_TIMESTAMP
        description: "{{ doc('inserted_timestamp') }}"

      - name: MODIFIED_TIMESTAMP
        description: "{{ doc('modified_timestamp') }}"

version: 2

models:
  - name: streamline__topshot_metadata_historical
    config:
      materialized: view
      tags: ['streamline', 'topshot', 'moments_metadata', 'backfill']
    meta:
      streamline:
        enabled: true
        http:
          method: POST
          headers:
            Content-Type: application/json
            Accept: application/json
            Accept-Encoding: gzip
            Connection: keep-alive
            User-Agent: Flipside_Flow_metadata/0.1
          body_column: payload
          url_column: base_url
          timeout: 45  
        target:
          schema: bronze_streamline
          table: moments_minted_metadata_api  
          unique_key:
            - contract
            - id
          response_column: data
        concurrency:
      
          async_concurrent_requests: 10 
          worker_batch_size: 100  
          producer_batch_size: 1  
        retries:

          max_retries: 3
          min_retry_delay_ms: 10000  
          max_retry_delay_ms: 120000  